function twoMinDpackets(a,b){var c=$.extend({},{ajax_url:"http://"+document.domain},b),d=function(b){a.showMessage("Nastala chyba!","("+b.response+") "+b.message)},e=function(a){return a.error?(d({reason:"unspecified",message:"unspecified"}),!1):a.response&&"success"!==a.response?(d(a),!1):!0};return this.packetSimple=function(a,b){$.ajax({url:c.ajax_url+a,dataType:"json"}).done(function(a){e(a)&&b&&b(a)})},this.packetBlock=function(a,b,c,d,e){var f="/wall/block?x="+a+"&y="+b+"&lastUpdate="+c+"&includeDeleted="+d;this.packetSimple(f,e)},this.packetEditBlock=function(a,b,c,d){var e="/wall/editblock?x="+a+"&y="+b+"&title="+encodeURIComponent(c)+"&description="+encodeURIComponent(d);this.packetSimple(e)},this.packetAdd=function(a,b,c,d,e,f){var g="/wall/add?block_x="+a+"&block_y="+b+"&x="+c+"&y="+d+"&content="+encodeURIComponent(e);f&&(g=g+"&parent="+f),this.packetSimple(g)},this.packetMove=function(a,b,c){var d="/wall/move?id="+a+"&x="+b+"&y="+c;this.packetSimple(d)},this.packetRemove=function(a){var b="/wall/remove?id="+a;this.packetSimple(b)},this.packetRenew=function(a){var b="/wall/renew?id="+a;this.packetSimple(b)},this.packetSearch=function(a,b){var c="/wall/search?search="+encodeURIComponent(a);this.packetSimple(c,b)},this.packetLatest=function(a,b,c,d,e){var f="/latest/latest?lastUpdate="+a+"&includeDeleted="+b;c&&(f=f+"&limit="+c),d&&(f+="&blocks=1"),this.packetSimple(f,e)},this.packetMap=function(a,b,c,d,e,f){var g="/map/map?lastUpdate="+e+"&x1="+a+"&y1="+b+"&x2="+c+"&y2="+d;this.packetSimple(g,f)},this.packetChangeColor=function(a,b){var c="/wall/changeColor?color="+encodeURIComponent(a)+"&background="+encodeURIComponent(b);this.packetSimple(c)},this.packetSystem=function(b,c){var d="/wall/system?x="+b+"&y="+c;this.packetSimple(d,function(b){b.online&&$(".online-counter").text(b.online),b.forceReload&&location.reload(),b.sysmessage&&a.showMessage("Systemova sprava:",b.sysmessage)})},this}function twoMinDutils(a){var b=$.extend({},{block_size:2100,blocksHolder:!1},a);return this.stuped=function(){alert("stuped")},this.getScreenCenterBlockPosition=function(){var a=Math.round(-1*b.blocksHolder.position().left+$(window).width()/2),c=Math.round(-1*b.blocksHolder.position().top+$(window).height()/2);return[a,c]},this.getScreenBlockPositionAt=function(a,c){var d=Math.round(-1*b.blocksHolder.position().left+$(window).width()*a),e=Math.round(-1*b.blocksHolder.position().top+$(window).height()*c);return[d,e]},this.getScreenCenterBlock=function(){var a=this.getScreenCenterBlockPosition(),c=Math.floor(a[0]/b.block_size),d=Math.floor(a[1]/b.block_size);return[c,d]},this.getScreenRangeBlocks=function(){var a=this.getScreenBlockPositionAt(0,0),c=this.getScreenBlockPositionAt(1,1),d=Math.floor(a[0]/b.block_size),e=Math.floor(a[1]/b.block_size),f=Math.floor(c[0]/b.block_size),g=Math.floor(c[1]/b.block_size);return[d,e,f,g]},this.getScreenCenterLocalBlockPosition=function(){var a=this.getScreenCenterBlockPosition(),c=this.getScreenCenterBlock(),d=a[0]-c[0]*b.block_size,e=a[1]-c[1]*b.block_size;return[d,e]},this.getScreenFloatBlockPosition=function(){var a=this.getScreenCenterLocalBlockPosition(),c=this.getScreenCenterBlock(),d=c[0]+a[0]/b.block_size,e=c[1]+a[1]/b.block_size;return[d,e]},this.showMessage=function(a,b){$("#messageReveal").foundation("reveal","open"),$("#messageReveal h2").text(a),$("#messageReveal p").text(b)},this.isColorDark=function(a){return this.isColorPartDark(a.substr(0,2))||this.isColorPartDark(a.substr(2,4))||this.isColorPartDark(a.substr(4,6))},this.isColorPartDark=function(a){return parseInt(a,16)<80},this.prettyDate=function(a){var b=a.date.split(/[- :]/),c=new Date(b[0],b[1]-1,b[2],b[3],b[4],b[5]),d=((new Date).getTime()-c.getTime())/1e3;return 86400>d?60>d&&"Pred menej ako minutou"||120>d&&"Pred jednou minutou"||3600>d&&"Pred "+Math.floor(d/60)+" minutami"||7200>d&&"Pred jednou hodinou"||86400>d&&"Pred "+Math.floor(d/3600)+" hodinami":c.toLocaleString()},this}TwoMinD=function(){return this.blocksHolder=$(".blocks-holder"),this.utils=new twoMinDutils({blocksHolder:blocksHolder}),this.packets=new twoMinDpackets(this.utils,twoMinDsettings),this.setupBasic=function(){$(".settings-form").twoMinDsettings(this,twoMinDsettings),blocksHolder.twoMinDactions(this,twoMinDsettings),$("header .icon-list .search").twoMinDaction({action:"search_button"}),$(".right-off-canvas-menu .settings").twoMinDaction({action:"settings"}),$(".right-off-canvas-menu .fullscreen").twoMinDaction({action:"fullscreen"})},this.setupModerator=function(){blocksHolder.twoMinDmoderatorActions(this,twoMinDsettings),$(".right-off-canvas-menu .online").twoMinDmoderatorAction({action:"online"}),$("#userReveal .ban").twoMinDmoderatorAction({action:"userBan"}),$("#userReveal .unban").twoMinDmoderatorAction({action:"userUnban"}),$("#userReveal .removeAllPosts").twoMinDmoderatorAction({action:"userRemoveAllPosts"}),$("#postReveal .remove").twoMinDmoderatorAction({action:"postRemove"}),$("#postReveal .renew").twoMinDmoderatorAction({action:"postRenew"})},this.setupWall=function(){var a=!1;twoMinDsettings.presentation&&(a=twoMinDsettings.presentation),blocksHolder.twoMinDwall(this,twoMinDsettings),blocksHolder.twoMinDsystem(this,twoMinDsettings),blocksHolder.twoMinDblockEditing(this,twoMinDsettings),blocksHolder.twoMinDpost(this,twoMinDsettings),$(".blocks-holder-mover").twoMinDinfiniteMover({target:blocksHolder,arrowKeysEnabled:!a}),$("header .icon-list .spawn").twoMinDaction({action:"spawn",spawnToCenter:!0,posSpawn:{pos_x:.5,pos_y:.5},posLoad:twoMinDsettings.posLoad}),$("footer .icon.add").twoMinDaction({action:"add"}),$("#addReveal").twoMinDaction({action:"addReveal"}),$("#block_0_0 .search").twoMinDaction({action:"search_button"}),a?blocksHolder.twoMinDpresentation(this,twoMinDsettings):$(".start-presentation").parent().remove()},this.setupLatest=function(a){$(".latest-posts").twoMinDlatest(this,$.extend({},twoMinDsettings,{blocks:a}))},this.setupMap=function(){$(".blocks-holder-mover").twoMinDinfiniteMover({target:blocksHolder}),$("header .icon-list .spawn").twoMinDaction({action:"spawn",spawnToCenter:!0}),blocksHolder.twoMinDmap(this,twoMinDsettings)},this},$.fn.twoMinDactions=function(a,b){var c=$.extend({},{block_size:2100},b),d=this,e={search_button:function(a){var b=a.find("a"),c=a.find(".searchForm");if(Modernizr.touch){var d=!1;a.hover(function(){d=!0},function(){d=!1}),b.click(function(){return d?void c.submit():!1})}else b.click(function(){c.submit()});e.search_form(a)},search_form:function(a){var b=a.find(".searchForm");b.submit(function(){var a=b.find("input");return g(a.val()),a.val(""),!1})},spawn:function(a,b){var c=function(a,c){var e=0,f=0;return b.spawnToCenter&&(e=$(window).width()/2,f=$(window).height()/2),c&&b.posLoad?(e+=-1*b.posLoad.pos_x*b.block_size,f+=-1*b.posLoad.pos_y*b.block_size):b.posSpawn&&(e+=-1*b.posSpawn.pos_x*b.block_size,f+=-1*b.posSpawn.pos_y*b.block_size),d.css({left:e,top:f}),d.trigger("holderMoved"),!1};a.click(c),c(null,!0)},settings:function(a){a.click(function(){return $("#settingsReveal").foundation("reveal","open"),!1})},fullscreen:function(a){a.click(function(){return $.fullscreen.isFullScreen()?$.fullscreen.exit():$("body").fullscreen(),!1})},add:function(a){a.click(function(){$("#addReveal").foundation("reveal","open")});var b=!1;$(document).on("opened.fndtn.reveal","[data-reveal]",function(){b=!0}),$(document).on("closed.fndtn.reveal","[data-reveal]",function(){b=!1}),$("body").keypress(function(a){b||0!==a.which&&0!==a.charCode&&0===$("input:focus").size()&&$("#addReveal").foundation("reveal","open")})},addReveal:function(b){var c=b.find(".text"),d=null;b.find("form").submit(function(){var e=a.utils.getScreenCenterBlock(),f=a.utils.getScreenCenterLocalBlockPosition(),g=c.val();return 0===g.length?(b.foundation("reveal","close"),!1):(a.packets.packetAdd(e[0],e[1],f[0],f[1],g,d),b.foundation("reveal","close"),!1)}),$(document).on("opened.fndtn.reveal","[data-reveal]",function(){"addReveal"===$(this).attr("id")&&c.focus()}),$(document).on("closed.fndtn.reveal","[data-reveal]",function(){"addReveal"===$(this).attr("id")&&(c.val(""),d=null)}),$(".blocks-holder").on("postCreated",function(a,c){c.find(".reply").mousedown(function(){d=c.attr("id").substring(5),b.foundation("reveal","open")})}),c.keypress(function(a){13===a.which&&(a.preventDefault(),a.shiftKey||a.ctrlKey?c.val(c.val()+"\n"):b.find("form").submit())}),c.maxlength({max:210,feedbackText:"{c}/{m}"})}},f=function(a){var b=$(".search-results");b.empty(),a.blocks?$.each(a.blocks,function(a,c){var d="block_"+c.block_x+"_"+c.block_y;b.append('<li><a href="#'+d+'" class="block-title">'+c.title+'<span class="coord"> ['+c.block_x+", "+c.block_y+'] </span><div class="block-description">'+c.description+"</div></a></li>")}):b.append("<li>Neboli nájdene žiadne témy.</li>"),b.find("a").click(function(){setTimeout(h,100),$("#searchReveal").foundation("reveal","close")}),$("#searchReveal").foundation("reveal","open")},g=function(b){a.packets.packetSearch(b,function(a){f(a)})},h=function(){var a=window.location.hash.slice(1);if(a.match("^block_")){var b=0,d=0,e=a.substring(6).split("_");e.length>=2&&(b+=-1*parseInt(e[0])*c.block_size,d+=-1*parseInt(e[1])*c.block_size),e.length>=4&&(b+=-1*parseInt(e[2]),d+=-1*parseInt(e[3]),b+=$(window).width()/2,d+=$(window).height()/2),$(".blocks-holder").css({left:b,top:d}),$(".blocks-holder").trigger("holderMoved")}};setTimeout(h,100),$(window).on("hashchange",function(){h()}),$.fn.twoMinDaction=function(a){var b=this,d=$.extend({},{action:!1,blocksHolder:$(".blocks-holder"),block_size:c.block_size},a);d.action&&$.each(e,function(a,c){d.action===a&&c(b,d)})}},$.fn.twoMinDblockEditing=function(a,b){var c=this,d=$.extend({},{block_size:2100},b),e=$(".coords .x"),f=$(".coords .y"),g=$("#blockInfo .title"),h=$("#blockInfo .description"),i=[0,0],j=function(b){var c=a.utils.getScreenCenterBlock();if(b||i[0]!==c[0]||i[1]!==c[1]){var d=$("#block_"+c[0]+"_"+c[1]),j=d.find(".title").text(),k=d.find(".description").text();e.val(c[0]),f.val(c[1]),g.is(":focus")||(g.val(j),g.trigger("changeLength")),h.is(":focus")||(h.val(k),h.trigger("changeLength")),0===c[0]&&0===c[1]?(g.attr("disabled","disabled"),h.attr("disabled","disabled")):(g.removeAttr("disabled"),h.removeAttr("disabled")),i=c}};c.on("drag",function(){j(!1)}),c.on("holderMoved",function(a,b){void 0===b&&(b=!0),j(b)}),j(!0),c.on("blockInfoUpdate",function(a,b){parseInt(b.block_x)===i[0]&&parseInt(b.block_y)===i[1]&&j(!0)}),$(".coords input").bind("paste keyup",function(){var a=parseInt(e.val()),b=parseInt(f.val());isNaN(a)||isNaN(b)||(a!==i[0]||b!==i[1])&&(c.css({left:-1*a*d.block_size,top:-1*b*d.block_size}),c.trigger("holderMoved"))}),$("#blockInfo .title, #blockInfo .description").bind("change paste keyup",function(){a.packets.packetEditBlock(i[0],i[1],g.val(),h.val())})},$.fn.twoMinDinfiniteMover=function(a){var b=this,c=$.extend({},{target:null,draggDelay:100,draggDistance:5,zoomEnabled:!1,mobileZoomEnabled:!1,zoom_min:.4,zoom_start:1,zoom_max:2,arrowKeysEnabled:!0,arrowKeysSpeed:40,mousewheelEnabled:!0,mousewheelMoveSpeed:12.6},a),d={top:0,left:0},e=c.zoom_start,f=function(a,b){c.target.offset(j(i(d,b.position)))},g=function(a,c){d=i(d,c.position),k(),b.css({top:0,left:0})},h=function(a,b){d=b.position},i=function(a,b){return{top:a.top+b.top,left:a.left+b.left}},j=function(a){return{top:a.top/e,left:a.left/e}},k=function(){c.target.offset(j(d))};if(b.draggable({drag:f,stop:g,delay:c.draggDelay,distance:c.draggDistance}),c.target.draggable({stop:h,delay:c.draggDelay,distance:c.draggDistance}),c.target.on("forceUpdateFixedPos holderMoved",function(){d=c.target.position()}),c.zoomEnabled&&$(document).bind("mousewheel",function(a){var b=a.deltaY,d=Math.min(Math.abs(b/100),.2);0>b&&(d*=-1),e+=d,e<c.zoom_min&&(e=c.zoom_min),e>c.zoom_max&&(e=c.zoom_max),c.target.css({transform:"scale("+e+")"})}),c.mobileZoomEnabled){var l=1;$(".blocks-holder").swipe({pinchStatus:function(a,b,d,f,g,h,i){"start"===b&&(l=e),e=l*i,e<c.zoom_min&&(e=c.zoom_min),e>c.zoom_max&&(e=c.zoom_max),c.target.css({transform:"scale("+e+")"})},fingers:2,pinchThreshold:0})}c.mousewheelEnabled&&$(document).bind("mousewheel",function(a){var b=Math.min(Math.abs(a.deltaX/50),1),d=Math.min(Math.abs(a.deltaY/50),1);a.deltaX<0&&(b*=-1),a.deltaY<0&&(d*=-1);var e=c.target.position();c.target.css({top:e.top+a.deltaY*c.mousewheelMoveSpeed,left:e.left+a.deltaX*c.mousewheelMoveSpeed}),c.target.trigger("holderMoved",[!1])}),c.arrowKeysEnabled&&$(document).keydown(function(a){if(0===$("input:focus").size()){var b=c.target.position();switch(a.which){case 37:c.target.css({left:b.left+c.arrowKeysSpeed});break;case 38:c.target.css({left:b.left+c.arrowKeysSpeed});break;case 39:c.target.css({left:b.left+-1*c.arrowKeysSpeed});break;case 40:c.target.css({top:b.top+-1*c.arrowKeysSpeed});break;default:return}}c.target.trigger("holderMoved",[!1])})},$.fn.twoMinDlatest=function(a,b){var c=this,d=$.extend({},{speed:9e3,limit:!1,blocks:!1,template_post:'<li><a href="#"><div class="post-content"></div><span class="coord"></span></a></li>',template_block:'<li><a href="#"><h3 class="title"></h3><div class="description"></div><span class="coord"></span></a></li>'},b),e=0,f=function(){var b="0";0!==e&&(b="1"),a.packets.packetLatest(e,b,d.limit,d.blocks,function(a){a.posts&&g(a.posts),e=a.now})},g=function(a){if($.each(a,function(a,b){if(d.blocks)var f="latest_post_"+b.block_x+"_"+b.block_y;else var f="latest_post_"+b.id;var g=!1,h=c.find("#"+f);h.size()||b.deleted||(h=$(d.blocks?d.template_block:d.template_post),h.attr("id",f),0===e?c.append(h):c.prepend(h),g=!0),b.deleted?h.size()&&(c.trigger("latestPostRemoved",[h]),h.remove()):(d.blocks?(h.find(".title").text(b.title),h.find(".description").text(b.description)):h.find(".post-content").text(b.content),h.find(".coord").text(" ["+b.block_x+", "+b.block_y+"] "),d.blocks?h.find("a").attr("href",d.ajax_url+"/wall#block_"+b.block_x+"_"+b.block_y):h.find("a").attr("href",d.ajax_url+"/wall#block_"+b.block_x+"_"+b.block_y+"_"+b.local_x+"_"+b.local_y),g?c.trigger("latestPostCreated",[h]):(c.prepend(h.remove()),c.trigger("latestPostUpdate",[h])))}),d.limit)for(a=c.find("li");a.size()>d.limit;)a.last().remove(),a=c.find("li")};setInterval(function(){f()},d.speed),f()},$.fn.twoMinDmap=function(a,b){var c=this,d=$.extend({},{speed:2e3,template:'<div class="map-block"><div class="block-info"><h3 class="title"><a href="#"></a></h3><span class="description"></span><div class="coords"></div></div></div>',block_size:100},b),e=0,f=null,g=new twoMinDutils({block_size:d.block_size,blocksHolder:c}),h=function(){var b=g.getScreenRangeBlocks();null!==f&&(f[0]!==b[0]||f[1]!==b[1]||f[3]!==b[3]||f[4]!==b[4])&&(e=0),f=b,a.packets.packetMap(b[0],b[1],b[2],b[3],e,function(a){e=a.now,a.blocks&&i(a.blocks)})},i=function(a){$.each(a,function(a,b){var e="map_"+b.block_x+"_"+b.block_y,f=c.find("#"+e);f.size()||(f=j(e)),f.find(".title a").attr("href",d.ajax_url+"/wall#block_"+b.block_x+"_"+b.block_y),f.find(".title a").text(b.title),f.find(".description").text(b.description),f.find(".coords").text("["+b.block_x+", "+b.block_y+"]"),f.css({left:b.block_x*d.block_size,top:b.block_y*d.block_size});for(var g=f.find(".block-info");f.height()>d.block_size||f.width()>d.block_size;)g.css("font-size",parseInt(g.css("font-size"))-1);c.trigger("mapBlockUpdate",[f])})},j=function(a){var b=$(d.template);return b.attr("id",a),c.append(b),c.trigger("mapBlockCreaated",[b]),b};setInterval(function(){h()},d.speed),h()},$.fn.twoMinDmoderatorActions=function(a,b){var c=$.extend({},{user_template:'<li><a href="#"></a></li>'},b),d=this,e={online:function(b,c){b.click(function(){return a.packets.packetSimple("/users/users",function(a){if(a.users){$("#usersReveal").foundation("reveal","open");var b=$("#usersReveal .users-list");b.empty(),$.each(a.users,function(a,d){var e=$(c.user_template);e.css("background",d.color),e.find("a").text(d.id),e.click(function(){$("#usersReveal").foundation("reveal","close")}),e.twoMinDmoderatorAction({action:"user",user:d.id}),b.append(e)})}}),!1})},user:function(b,c){b.click(function(){return $("#userReveal").foundation("reveal","open"),a.packets.packetSimple("/users/user?id="+c.user,function(b){if(b.user){try{$("#userReveal").foundation("reveal","open")}catch(c){}var d=$("#userReveal");$.each(b.user,function(b,c){null===c&&(c="-"),c.date&&(c=a.utils.prettyDate(c)),d.find("."+b).text(c)})}}),!1})},post:function(b,c){b.click(function(){return a.packets.packetSimple("/wall/post?id="+c.post,function(b){if(b.post){$("#postReveal").foundation("reveal","open");var c=$("#postReveal");$.each(b.post,function(b,d){null===d&&(d="-"),d.date&&(d=a.utils.prettyDate(d)),c.find("."+b).text(d)})}}),!1})},userBan:function(b){b.click(function(){var c=b.closest(".reveal-modal").find(".id").text();a.packets.packetSimple("/users/ban?id="+c+"&reason="+encodeURIComponent("moderator")),$("#userReveal").foundation("reveal","close")})},userUnban:function(b){b.click(function(){var c=b.closest(".reveal-modal").find(".id").text();a.packets.packetSimple("/users/unban?id="+c),$("#userReveal").foundation("reveal","close")})},userRemoveAllPosts:function(b){b.click(function(){var c=b.closest(".reveal-modal").find(".id").text();a.packets.packetSimple("/users/removeAllPosts?id="+c),$("#userReveal").foundation("reveal","close")})},postRemove:function(b){b.click(function(){var c=b.closest(".reveal-modal").find(".id").text();a.packets.packetSimple("/wall/remove?id="+c),$("#postReveal").foundation("reveal","close")})},postRenew:function(b){b.click(function(){var c=b.closest(".reveal-modal").find(".id").text();a.packets.packetSimple("/wall/renew?id="+c),$("#postReveal").foundation("reveal","close")})}};$.fn.twoMinDmoderatorAction=function(a){var b=this,d=$.extend({},c,a),f=$.extend({},{action:!1,blocksHolder:$(".blocks-holder")},d);f.action&&$.each(e,function(a,c){f.action===a&&c(b,f)})},d.on("postCreated",function(a,b){var c=$(b),d=parseInt(b.attr("id").substring(5));c.twoMinDmoderatorAction({action:"post",post:d})})},$.fn.twoMinDpost=function(a,b){var c=$.extend({},{draggDelay:100,draggDistance:5,moderator:!1},b),d=$("footer .icon.delete"),e=$("footer .icon.add");d.hide();var f=function(b,c){a.packets.packetMove(b,Math.round(c.left),Math.round(c.top))},g=function(b){a.packets.packetRemove(b)},h=function(a,b){return b.offset().top<a.top&&b.offset().left<a.left&&b.offset().top+b.height()>a.top&&b.offset().left+b.width()>a.left},i=function(){d.show(),e.hide()},j=function(a){var b=$(a.target);if(b.hasClass("post-group"))var c=parseInt(b.children().first().attr("id").substring(5));else var c=parseInt(b.attr("id").substring(5));h({left:a.pageX,top:a.pageY},d)?(g(c),b.hide()):(f(c,b.position()),k(b)),d.hide(),e.show()},k=function(a){var b=a.collision(a.parent().find("> .post"),{as:"<div />",obstacleData:"collision-obstacle",directionData:"collision-direction"});b.each(function(){var b=$(this).data("collision-obstacle");if(b.attr("id")!==a.attr("id")){var c=$(this).data("collision-direction"),d=0,e=0;"S"===c&&(e+=$(this).height()),"N"===c&&(e+=-$(this).height()),"E"===c&&(d+=$(this).width()),"W"===c&&(d+=-$(this).width()),"Inside"===c&&(d+=$(this).height()),"Outside"===c&&(d+=$(this).height()),"SE"===c&&($(this).height()<$(this).width()?e+=$(this).height():d+=$(this).width()),"NE"===c&&($(this).height()<$(this).width()?e-=$(this).height():d+=$(this).width()),"NW"===c&&($(this).height()<$(this).width()?e-=$(this).height():d-=$(this).width()),"SW"===c&&($(this).height()<$(this).width()?e=$(this).height():d-=$(this).width()),l(b,{left:d,top:e})}})},l=function(a,b){a.css({left:a.position().left+b.left,top:a.position().top+b.top});var c=parseInt(a.attr("id").substring(5));f(c,a.position())};$(".blocks-holder").on("postCreated",function(a,b,d){d.parent?b.parent().hasClass("post-group")&&b.parent().draggable({start:i,stop:j,containment:b.parent().parent().parent(),delay:c.draggDelay,distance:c.draggDistance}):b.hasClass("post")&&b.draggable({start:i,stop:j,containment:b.parent().parent(),delay:c.draggDelay,distance:c.draggDistance}),b.mousedown(function(){$(".post").removeClass("selected"),$(this).addClass("selected")})})},$.fn.twoMinDpresentation=function(a,b){var c=this,d=!1,e=-1,f=!1,g=$.extend({},{block_size:2100,autoplay:!0,moveSpeed:800,autoplay_speed:2e3},b),h=[{x:.5,y:.1},{x:.5,y:.5},{x:-.5,y:.5}],i={block_0_0:function(){var a=$('<h1 class="logo"><sup>2</sup><span class="anim">min</span><sub>D</sub></h1>');a.css({color:"white","text-align":"center","font-size":200}),c.find("#block_0_0").append(a);var b=$('<h2 class="logo">Dominik Gmiterko</h2>');b.css({color:"#F93","text-align":"center"}),c.find("#block_0_0").append(b)},"block_-1_0":function(){var a=$('<div class="row"><div class="small-4 columns"><img src="'+g.ajax_url+'/images/presentation/vyuzitie/komunikacia.svg" /></div><div class="small-8 columns"><h4>Komunikácia</h4><p>Na tejto stranke mozu prebiehat akekolvek rozhovory.</p><ul><li>Priklady</li><li>Priklady</li><li>Priklady</li></ul></div></div>');a.css({"margin-top":1e3}),a.find("img").css({"float":"right"}),c.find("#block_-1_0").append(a)}},j=function(){$.each(i,function(a,b){b()})};c.on("blockCreated",function(a,b){if(d){var c=i[b];c&&c()}});var k=function(){var a=$(window).width()/2,b=$(window).height()/2;a+=-1*h[e].x*g.block_size,b+=-1*h[e].y*g.block_size,f=!0,$(c).animate({left:a,top:b},g.moveSpeed,function(){f=!1})},l=function(){f||e<h.length-1&&(e++,k())},m=function(){f||e>0&&(e--,k())},n=function(){e>=0||(e=0,k(),$(document).keydown(function(a){switch(a.which){case 37:m();break;case 39:l()}}))};$(".start-presentation").click(function(){d||(j(),d=!0),n()})},$.fn.twoMinDsettings=function(a,b){var c=this,d=$.extend({},{template_color:'<a href="#" class="color"></a>'},b);c.find(".color-selector").each(function(b,c){$(c).twoMinDcolorSelector(a.utils,d)}),c.submit(function(){var a=c.find(".posts-color .color-field").val(),b=c.find(".background-color .color-field").val();return e(a,b),f(b),$("#settingsReveal").foundation("reveal","close"),!1});var e=function(b,c){b=b.substring(1),a.packets.packetChangeColor(b,c)},f=function(a){if(a){var b="";b=a.match("^#")?a:"url("+a+")",$("#wall").css({background:b,"background-attachment":"fixed","background-size":"cover"})}},g=c.find(".background-color .color-field").val();g&&f(g)},$.fn.twoMinDcolorSelector=function(){var a=this;a.find(".colors li a").each(function(b,c){var d=$(c);d.css("background",d.text()),d.click(function(b){a.find(".color-field").val(d.text()),a.find(".colors li a.selected").removeClass("selected"),$(this).addClass("selected"),b.preventDefault()})})},$.fn.twoMinDsystem=function(a,b){var c=$.extend({},{speed:9999},b),d=function(){var b=a.utils.getScreenFloatBlockPosition();a.packets.packetSystem(b[0],b[1])};setInterval(function(){d()},c.speed)},$(function(){$(".fullpage").css("height",$(window).height()),$(window).resize(function(){$(".fullpage").css("height",$(window).height())}),$(".fullpage-min").css("min-height",$(window).height()),$(window).resize(function(){$(".fullpage-min").css("min-height",$(window).height())}),$(".dynamic-width-input").each(function(){var a=$(this),b=a.prev();a.hide(),a.text(b.attr("placeholder"));var c=a.width();b.on("keypress changeLength",function(b){if(0!==b.which&&0!==b.charCode){var d=String.fromCharCode(b.keyCode|b.charCode);a.text($(this).val()+d);var e=a.width();c>e&&(e=c),$(this).css("width",e)}})})}),$.fn.twoMinDwall=function(a,b){var c=this,d=$.extend({},{speed:400,template_block:'<div class="block"></div>',template_post:'<p class="post"><span></span><time></time><a href="#" class="reply">Reply</a></p>',range:1,moderator:!1},b),e=function(b){var c="0";(0!==b.lastUpdate||d.moderator)&&(c="1"),a.packets.packetBlock(b.x,b.y,b.lastUpdate,c,function(a){f(a)})},f=function(a){var b=!1,d="block_"+a.block_x+"_"+a.block_y,e=c.find("#"+d);e.size()||(e=g(d),b=!0),b&&e.css({left:2100*a.block_x,top:2100*a.block_y}),e.data("lastUpdate",a.now),a.title&&(h(e,a.title,a.description),c.trigger("blockInfoUpdate",[{block_x:a.block_x,block_y:a.block_y},a.title,a.description])),a.posts&&i(e,a.posts)},g=function(a){var b=$(d.template_block);return b.attr("id",a),c.append(b),c.trigger("blockCreated",[a]),b},h=function(a,b,c){var d=a.find("h3.title");d.size()||(a.append('<h3 class="title"></h3>'),d=a.find("h3.title"));var e=a.find("p.description");e.size()||(a.append('<p class="description"></p>'),e=a.find("p.description")),d.text(b),e.text(c)},i=function(b,e){var f=b.find(".posts");f.size()||(b.append('<div class="posts"></div>'),f=b.find(".posts")),$.each(e,function(b,e){var g="post_"+e.id,h=!1,i=f.find("#"+g);if(i.size()||e.deleted&&!d.moderator||(i=$(d.template_post),i.attr("id",g),f.append(i),h=!0),h&&e.parent){i.hide();var k="#post_"+e.parent,l=f.find(k);l.size()?j(i,l):c.on("postCreated",function(a,b){b.attr("id")===k&&j(i,b)})}e.deleted&&!d.moderator?i.size()&&(c.trigger("postRemoved",[i]),i.remove()):(i.find("span").text(e.content),i.find("time").text(a.utils.prettyDate(e.created)),e.parent||(i.parent().hasClass("post-group")?i.parent().css({left:e.local_x,top:e.local_y}):i.css({left:e.local_x,top:e.local_y})),i.css({background:"#"+e.color}),i.css(a.utils.isColorDark(e.color)?{color:"#FFF"}:{color:"#000"}),i.height()<=26&&i.css({"white-space":"nowrap"}),d.moderator&&e.deleted&&i.addClass("deleted")),h?c.trigger("postCreated",[i,e]):c.trigger("postUpdate",[i,e])})},j=function(a,b){if(!b.parent().hasClass("post-group")){var c=b.parent();b=b.remove();var d=$('<div class="post-group"></div>');c.append(d),d.append(b),d.css({top:b.position().top,left:b.position().left}),b.css({top:"auto",left:"auto"})}a.remove().insertAfter(b),a.show()};setInterval(function(){var b=a.utils.getScreenCenterBlock(),f=0,g=null,h=[];$(".block").each(function(){h.push($(this))});for(var i=b[0]-d.range;i<=b[0]+d.range;i++)for(var j=b[1]-d.range;j<=b[1]+d.range;j++){var k=0,l="0",m=c.find("#block_"+i+"_"+j);m.size()&&m.data("lastUpdate")&&(l=m.data("lastUpdate"),k=new Date(l.replace(" ","T")).getTime()),i===b[0]&&j===b[1]&&k>0&&(k-=8*d.speed),$.each(h,function(a,b){b&&b.attr("id")==="block_"+i+"_"+j&&h.splice(a,1)}),(f>k||0===f)&&(f=m.size()?k:1,g={x:i,y:j,lastUpdate:l})}$.each(h,function(a,b){b&&"block_0_0"!==b.attr("id")&&b.remove()}),g&&e(g)},d.speed),c.click(function(){document.getSelection().removeAllRanges(),$("input:focus").blur()}),e({x:0,y:0,lastUpdate:0})};